{% extends "base.html" %}
{% block title %}Profile - {{ user.username }}{% endblock %}
{% block content %}
<h2>{{ user.username }}</h2>

<div class="row">
  <div class="col-md-4">
    <img src="{{ url_for('static', filename='uploads/' ~ user.profile_image) }}" class="img-fluid rounded mb-3" alt="profile" style="max-width:200px;">
    {% if not public %}
      <form method="POST" enctype="multipart/form-data">
        <label class="form-label">Change profile image</label>
        <input type="file" name="profile_image" class="form-control mb-2" accept="image/*">
        <button class="btn btn-primary btn-sm">Upload</button>
      </form>
    {% endif %}
    <p class="mt-2"><strong>Email:</strong> {{ user.email }}</p>
  </div>

  <div class="col-md-8">
    <h4>Vacancies by {{ user.username }}</h4>
    <a class="btn btn-success mb-2" href="{{ url_for('add_vacancy') }}">+ Add New Vacancy</a>
    {% for v in vacancies %}
      <div class="card mb-2">
        <div class="card-body">
          <h5>{{ v.title }}</h5>
          <p class="text-muted">{{ v.created_at.strftime('%Y-%m-%d') }} â€” <span class="badge bg-info">{{ v.category }}</span></p>
          <p>{{ v.short_description }}</p>
          <a class="btn btn-sm btn-primary" href="{{ url_for('vacancy_detail', vacancy_id=v.id) }}">Read More</a>
          {% if not public and current_user.is_authenticated and current_user.id == v.author_id %}
            <a class="btn btn-sm btn-secondary" href="{{ url_for('edit_vacancy', vacancy_id=v.id) }}">Edit</a>
            <form action="{{ url_for('delete_vacancy', vacancy_id=v.id) }}" method="post" style="display:inline;">
              <button class="btn btn-sm btn-danger" onclick="return confirm('Delete?')">Delete</button>
            </form>
          {% endif %}
        </div>
      </div>
    {% else %}
      <div class="alert alert-info">No vacancies yet.</div>
    {% endfor %}
  </div>
</div>
{% endblock %}
